app.controller("BookingController",function(t,o,n,r){t.$routeParams=n,t.sortType="id",t.sortReverse=!0,t.$routeParams.tourId?o.post("/booking/getByTour",t.$routeParams).success(function(o){t.data=o}).error(function(){swal({title:"Không thể lấy dữ liệu từ tour này. Vui lòng liên hệ với quản trị viên",text:"",type:"error"})}):o.get("/booking/indexApi").success(function(o){t.data=o}),o.get("/tour/indexApi").success(function(o){t.tour=o}),t.totalPrice=function(t){return t.tour.giatreem*t.sotreem+t.tour.gianguoilon*t.songuoilon},t.add=!0,t.addBooking=function(){$(".bookingForm").addClass("display"),t.add=!0},t.cancel=function(){$(".popUp").removeClass("display")},t.postNew=function(){o.post("/booking",t.cur).success(function(o){o.ngaydi=o.ngaydi.substring(0,10),t.data.push(o),swal("Thêm thành công tour mới","","success")}).error(function(t){swal({title:"<b>Lỗi! Không thể thêm booking mới</b>",text:r.arrayToList(t),html:!0,type:"error"})}),$(".popUp").removeClass("display")},t.delete=function(n){confirm("Bạn có muốn xóa tour này?")&&o.delete("/booking/"+n.id).success(function(){t.data.splice(t.data.indexOf(n),1),swal("Xóa thành công","","success")}).error(function(t){swal({title:"<b>Có lỗi xảy ra, không thể xóa tour này</b>",text:r.arrayToList(t),html:!0,type:"error"})})},t.edit=function(o){jQuery(".bookingForm").addClass("display"),t.add=!1,t.cur=o},t.update=function(){o.put("/booking/"+t.cur.id,t.cur).success(function(o){swal("Cập nhật thành công booking của "+o.hoten,"","success");for(var n=0;n<t.data.length;n++)if(t.data[n].id==t.id){t.data[n]=o;break}jQuery(".popUp").removeClass("display")}).error(function(t){jQuery(".popUp").removeClass("display"),swal({title:"<b>Lỗi! Không thể cập nhật</b>",text:r.arrayToList(t),html:!0,type:"error"})})},t.chitiet=function(o){t.cur=o,jQuery(".chiTietBooking").addClass("display")},t.searchBooking=function(){o.post("/booking/searchApi",{searchString:t.searchString}).success(function(o){t.data=o}).error(function(){swal("Lỗi! Không tìm kiếm được.","","error")})}});